<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="bootstrap4.css">
    <title>üöÄ - to the moon!</title>
  </head>
  <body class="d-block p-3">
	<ul class="nav nav-pills nav-fill">
	  <li class="nav-item">
		<a class="nav-link active bg-dark" id="txt_encrypt" href="encrypt.html">Encrypt üì§</a>
	  </li>
	  <li class="nav-item">
		<a class="nav-link" href="decrypt.html" id="txt_decrypt">Decrypt üì•</a>
	  </li>
	</ul>
	<hr>
	<form class="form">
		Text üìÑ ‚û°Ô∏è üåà Emoji
	  <div class="input-group mb-3">
		<div class="input-group-prepend">
			<span class="input-group-text">‚úâÔ∏è</span>
		</div>
		<textarea class="form-control" placeholder="Message" aria-label="Emoji" id="inputText" rows="5"></textarea>
	  </div>
	  	<label for="emcode">Encrypt messages with an optional password. Use the generate button when you need a good one.</label>
		<div class="input-group mb-3">
		  <div class="input-group-prepend">
			<span class="input-group-text" id="emcode">üîë</span>
		  </div>
		  <input type="text" placeholder="(optional)" class="form-control" id="inputKey" aria-describedby="emcode"> 
		  <div class="input-group-append">
			<button id="btnKeyGenerate" type="button" class="btn btn-primary btn-block bg-dark">Generate</button>
		  </div>
		  <div class="input-group-append">
			<button id="copyKey" type="button" class="btn btn-primary bg-dark btn-block">Copy</button>
	    </div>
		</div>
	
	 <button id="btnEncode" type="button" class="btn btn-primary bg-dark btn-block mb-2">Convert / Encrypt</button>
	</form>
	<hr>
	<div class="input-group mb-3">
	  <textarea class="form-control" aria-label="Emoji" id="out" rows="10" readonly>Copy from here</textarea>
	  	<div class="input-group-append">
			<button id="copyMessage" type="button" class="btn bg-dark btn-block">Copy <br>to clipboard</button>
	    </div>
	</div>
	<hr>
	<p class="text-center">
		<b id="footer">On device AES encryption. No data sent. No cookies. <br> Anti-Bruteforce/ASIC</b> 
	</p>
	<div class="text-center">
		<a href="https://github.com/mqxym/EmojiCrypt" id="footerSource">Sourcecode</a>
	</div>
	

    <!-- 
		Todo:
		- copy button for URL
		- add colors for status message
		- save password as a cookie
		- languages (ger, span, port, rus, japan etc)
	-->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
	<script src="emo.js"></script>
	<script src="crypto.js"></script>

	<script>

	let emo = "üòÉüòÑüòÅüòÜüòÖüòÇü§£‚ò∫Ô∏èüòäüòáüôÇüôÉüòâüòåüòçüòòüòóüòôüòöüòãüòúüòùüòõü§ëü§óü§ìüòéü§°ü§†üòèüòíüòûüòîüòüüòïüôÅ‚òπÔ∏èüò£üòñüò´üò©üò§üò†üò°üò∂üòêüòëüòØüò¶üòßüòÆüò≤üòµüò≥üò±üò®üò∞üò¢üò•ü§§üò≠üòìüò™üò¥üôÑü§îü§•üò¨ü§êü§¢ü§Æü§ßüò∑ü§íü§ïü§®ü§©ü§Øüßêü§´ü§™ü§≠ü•±ü•≥ü•¥ü•∂ü•µüòàüëøü§¨üëπüë∫üí©üëªüíÄ‚ò†Ô∏èüëΩüëæü§ñüéÉüò∫üò∏üòπüòªüòºüòΩüòøüòæüôÄüê∂üê±üê≠üêπüê∞ü¶äüêªüêºüê®üêØü¶ÅüêÆüê∑üêΩüê∏üêµüôàüôâüôäüêíüêîüêßüê¶üê§üê£üê•ü¶Üü¶Öü¶âü¶áüê∫üêóüê¥ü¶Ñüêùüêõü¶ãüêåüêöüêûüêúüï∑üï∏üê¢üêçü¶éü¶Çü¶Äü¶ëüêôü¶êüê†üêüüê°üê¨ü¶àüê≥üêãüêäüêÜüêÖüêÉüêÇüêÑü¶åüê™üê´üêòü¶èü¶çüêéüêñüêêüêèüêëüêïüê©üêàüêìü¶ÉüïäüêáüêÅüêÄüêøüêæüêâüê≤ü¶ñü¶ïü¶íü¶îü¶ìü¶óü¶ßü¶Æü¶•ü¶¶ü¶®ü¶©üåµüéÑüå≤üå≥üå¥üå±üåø‚òòÔ∏èüçÄüéçüéãüçÉüçÇüçÅüçÑüåæüíêüå∑üåπü•Äüåªüåºüå∏üå∫üåéüåçüåèüåïüåñüåóüåòüåëüåíüåìüåîüåöüåùüåûüåõüåúüåôüí´‚≠êÔ∏èüåü‚ú®‚ö°Ô∏èüî•üí•‚òÑÔ∏èüõ∏‚òÄÔ∏èüå§‚õÖÔ∏èüå•üå¶üåà‚òÅÔ∏èüåß‚õàüå©üå®‚òÉÔ∏è‚õÑÔ∏è‚ùÑÔ∏èüå¨üí®üå™üå´üåäüíßüí¶‚òîÔ∏èüçèüçéüçêüçäüçãüçåüçâüçáüçìüçàüçíüçëüççü•ùü•ëüçÖüçÜü•íü•ïüåΩüå∂ü•îüç†üå∞ü•úüçØü•êüçûü•ñüßÄü•öüç≥ü•ìüßÑüßÖü•ûüßáüç§üçóüçñüçïüå≠üçîüçüü•ôüåÆüåØü•óü•òüçùüçúü¶™üç≤üç•üç£üç±üçõüçöüßÜüçôüçòüç¢üç°üçßüç®üç¶üç∞üéÇüçÆüç≠üç¨üç´üçøüç©üç™ü•õüßàüçº‚òïÔ∏èüçµüç∂üç∫üçªü•Çüç∑ü•Éüç∏üçπüçæüßâüßÉüßäü•Ñüç¥üçΩ‚öΩÔ∏èüèÄüèà‚öæÔ∏èüéæüèêüèâüé±üèìüè∏ü•Öüèíüèëüèè‚õ≥Ô∏èüèπüé£ü•äü•ã‚õ∏üéø‚õ∑üèÇüèãÔ∏è‚Äç‚ôÄÔ∏èüèãÔ∏èü§∫ü§º‚Äç‚ôÄÔ∏èü§º‚Äç‚ôÇÔ∏èü§∏‚Äç‚ôÄÔ∏èü§∏‚Äç‚ôÇÔ∏è‚õπÔ∏è‚Äç‚ôÄÔ∏è‚õπÔ∏èü§æ‚Äç‚ôÄÔ∏èü§æ‚Äç‚ôÇÔ∏èüèåÔ∏è‚Äç‚ôÄÔ∏èüèåÔ∏èüèÑ‚Äç‚ôÄÔ∏èüèÑüèä‚Äç‚ôÄÔ∏èüèäü§Ω‚Äç‚ôÄÔ∏èü§Ω‚Äç‚ôÇÔ∏èüö£‚Äç‚ôÄÔ∏èüö£ü§øüèáüö¥‚Äç‚ôÄÔ∏èüö¥üöµ‚Äç‚ôÄÔ∏èüöµüéñü•áü•àü•âüèÜüèµüéóüé´üéüüé™ü§π‚Äç‚ôÄÔ∏èü§π‚Äç‚ôÇÔ∏èüé≠üé®üé¨üé§üéßüéºüéπü•Åüé∑üé∫üé∏üéªü™ïüé≤üéØüé≥ü™Äü™ÅüéÆüé∞üöóüöïüöôüöåüöéüèéüöìüöëüöíüöêüööüöõüöúüõ¥üö≤üõµüèçüõ∫üö®üöîüöçüöòüöñüö°üö†üöüüöÉüöãüöûüöùüöÑüöÖüöàüöÇüöÜüöáüöäüöâüöÅüõ©‚úàÔ∏èüõ´üõ¨ü™Çüí∫üõ∂‚õµ  üõ≥‚õ¥üö¢‚öìÔ∏èüöß‚õΩÔ∏èüöèüö¶üö•üó∫üóøüóΩ‚õ≤Ô∏èüóºüè∞üèØüèüüé°üé¢üé†‚õ±üèñüèù‚õ∞üèîüóªüåãüèúüèï‚õ∫Ô∏èüõ§üõ£üèóüè≠üè†üè°üèòüèöüè¢üè¨üè£üè§üè•üè¶üè®üè™üè´üè©üííüèõ‚õ™Ô∏èüïåüïçüõïüïã‚õ©üóæüéëüèûüåÖüåÑüå†üéáüéÜüåáüåÜüèôüåÉüååü™êüåâüåÅ‚åöÔ∏èüì±üì≤üíª‚å®üñ•üñ®üñ±üñ≤üïπüóúüíΩüíæüíøüìÄüìºüì∑üì∏üìπüé•üìΩüéûüìû‚òéüìüüì†üì∫üìªüéôüéöüéõ‚è±‚è≤‚è∞üï∞‚åõÔ∏è‚è≥üì°üîãüîåüí°üî¶üïØüóëüõ¢üí∏üíµüí¥üí∂üí∑üí∞üí≥üíéüßø‚öñÔ∏èüîßüî®‚öíüõ†‚õèü™ìüî©‚öôÔ∏è‚õìüî´ü™Åüí£ü™íüî™üó°‚öîÔ∏èüõ°üö¨‚ö∞Ô∏è‚ö±Ô∏èüè∫ü™îüîÆüìøüíà‚öóÔ∏èüî≠üî¨üï≥ü¶Øü©∫üíäüíâü©∏ü©πü¶†üß´üß¨üå°üöΩüö∞üöøüõÅüõÄüõéüîëüóùüö™üõãüõèüõåü™ëüñºüõçüõíüéÅüéàüéèüéÄüéäüéâüééüèÆüéê‚úâÔ∏èüì©üì®üìßüíåüì•üì§üì¶üè∑üì™üì´üì¨üì≠üìÆüìØüìúüìÉüìÑüìëüìäüìàüìâüóíüóìüìÜüìÖüìáüóÉüó≥üóÑüìãüìÅüìÇüóÇüóûüì∞üììüìîüìíüìïüìóüìòüìôüìöüìñüîñüîóüìéüñáüìêüìèüìåüìçüéåüè≥Ô∏èüè¥üèÅüè≥Ô∏è‚Äçüåà‚úÇÔ∏èüñäüñã‚úíÔ∏èüñåüñçüìù‚úèÔ∏èüîçüîéüîèüîêüîíüîìüíÑüëöüëïüëñüëîüëóüëôüëòüë†üë°üë¢üëûüëüüëíüé©üéìüëë‚õëüéíüëùüëõüëúüíºüëìüï∂üåÇ‚òÇÔ∏èüíõüíöüíôüíúüñ§ü§éü§çüß°üíî‚ù£Ô∏èüíïüíûüíìüíóüíñüíòüíùüíü‚òÆÔ∏è‚úùÔ∏è‚ò™Ô∏èüïâ‚ò∏Ô∏è‚ú°Ô∏èüîØüïé‚òØÔ∏è‚ò¶Ô∏èüõê‚õé‚ôàÔ∏è‚ôâÔ∏è‚ôäÔ∏è‚ôãÔ∏è‚ôåÔ∏è‚ôçÔ∏è‚ôéÔ∏è‚ôèÔ∏è‚ôêÔ∏è‚ôëÔ∏è‚ôíÔ∏è‚ôìÔ∏èüÜî‚öõÔ∏èüà≥üâë‚ò¢Ô∏è‚ò£Ô∏èüì¥üì≥üà∂üàöÔ∏èüà∏üà∫üà∑Ô∏è‚ú¥Ô∏èüÜöüâê„äôÔ∏è„äóÔ∏èüà¥üàµüàπüà≤üÖ∞Ô∏èüÖ±Ô∏èüÜéüÜëüÖæÔ∏èüÜòüöº‚ùå‚≠ïÔ∏èüõë‚õîÔ∏èüìõüö´üíØüíÆüí¢‚ô®Ô∏èüö∑üöØüö≥üö±üîûüìµüö≠‚ùóÔ∏è‚ùï‚ùì‚ùî‚ÄºÔ∏è‚ÅâÔ∏èüîÖüîÜ„ÄΩÔ∏è‚ö†Ô∏èüö∏üî±‚öúÔ∏èüî∞‚ôªÔ∏è‚úÖüàØÔ∏èüíπ‚ùáÔ∏è‚ú≥Ô∏è‚ùéüåêüí†‚ìÇÔ∏èüåÄüí§üèßüöæ‚ôøÔ∏èüÖøÔ∏èüàÇÔ∏èüõÇüõÉüõÑüõÖüöπüö∫üöªüöÆ‚ûøüé¶üì∂üàÅüî£‚ÑπÔ∏èüî§üî°üî†üÜñüÜôüÜíüÜïüÜì‚ñ∂Ô∏è‚è∏‚èØ‚èπ‚è∫‚è≠‚èÆ‚è©‚è™‚è´‚è¨‚óÄÔ∏èüîºüîΩ‚û°Ô∏è‚¨ÖÔ∏è‚¨ÜÔ∏è‚¨áÔ∏è‚ÜóÔ∏è‚ÜòÔ∏è‚ÜôÔ∏è‚ÜñÔ∏è‚Ü™Ô∏è‚Ü©Ô∏è‚§¥Ô∏è‚§µÔ∏èüîÄüîÅüîÇüîÑüîÉüîöüîôüîõüîùüîú‚òëÔ∏è‚ÜïÔ∏è‚ÜîÔ∏èüéµüé∂‚ûï‚ûñ‚ûó‚úñÔ∏èüí≤üí±‚Ñ¢Ô∏è¬©Ô∏è¬ÆÔ∏è„Ä∞Ô∏è‚û∞‚úîÔ∏èüîò‚ö´Ô∏è‚ö™Ô∏èüî¥üîµüü£‚Äãüü†üü¢üü£üî∫üîªüî∏üîπüî∂üî∑üî≥üî≤‚ñ™Ô∏è‚ñ´Ô∏è‚óæÔ∏è‚óΩÔ∏è‚óºÔ∏è‚óªÔ∏è‚¨õÔ∏è‚¨úÔ∏èüüßüü©üü¶üîàüîáüîâüîäüîîüîïüì£üì¢üëÅ‚Äçüó®üí¨üí≠üóØ‚ô†Ô∏è‚ô£Ô∏è‚ô•Ô∏è‚ô¶Ô∏èüÉèüé¥üÄÑÔ∏èüïêüïëüïíüïìüïîüïïüïñüïóüïòüïôüïöüïõüïúüïùüïûüï°üï¢üï£üï§üï•üï¶üïß"

	$(document).ready(function(){

		emo_array = stringToArray(emo);
		emo_array = cleanArray(emo_array);

		if (isDebug()) {
			$("#inputText").val("Hello World!"); 
			let key1 = $("#inputKey").val();
			$("#inputKey").val("test")
		}


		$("#btnEncode").click(async function(){
			$(this).removeClass("bg-dark").removeClass("bg-success").addClass("bg-warning");
			$(this).html("Encrypting...");
			await new Promise(r => setTimeout(r, 15));

			let message = $("#inputText").val();
			let key1 = getPassword($("#inputKey").val(), getSecLevel());
			
			let textHex;
			let encryptedHex;
			let emojiString;
			let encryptedString;

			do {
				encryptedString = CryptoJS.AES.encrypt(message, key1).toString();
				encryptedHex = base64ToHex(encryptedString);
				emojiString = hexToEmo(encryptedHex, emo_array);
				testHex = emoToHex(emojiString, emo_array);
			} while (testHex != encryptedHex)

			$("#out").val(emojiString);
			$(this).removeClass("bg-warning").addClass("bg-success");
			$(this).html("Encrypted!");
		});

		$("#btnKeyGenerate").click(function(){
			$("#inputKey").val(generateRandomEmo(emo_array));
		});

		$("#copyKey").click(function(){
		 let copyText = document.getElementById("inputKey");
		  copyText.select();
		  copyText.setSelectionRange(0, 99999); 
		  document.execCommand("copy");
		});

		$("#copyMessage").click(function(){
		 let copyText = document.getElementById("out");
		  copyText.select();
		  copyText.setSelectionRange(0, 99999); 
		  document.execCommand("copy");
		});


	});
	</script> 
  </body>
</html>